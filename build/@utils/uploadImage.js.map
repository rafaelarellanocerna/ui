{"version":3,"file":"uploadImage.js","sources":["../../@utils/uploadImage.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { ApolloClient, gql, InMemoryCache } from '@apollo/client';\r\n\r\nconst queryUpload = gql`\r\n  query UploadFileUrl($orgCode: String!, $path: String!, $fileName: String!) {\r\n    uploadFileUrl(orgCode: $orgCode, path: $path, fileName: $fileName) {\r\n      url\r\n      fileName\r\n    }\r\n  }\r\n`;\r\n\r\ntype UploadFile = {\r\n  name: string;\r\n  orgcode: string;\r\n};\r\nconst removeWhiteSpaces = (name: string) =>\r\n  name?.replace(/\\s+/g, '')?.replace('(', '')?.replace(')', '');\r\n\r\nconst uploadImage = async (image: File, options?: UploadFile) => {\r\n  const endpoint = 'https://file-service.staging.ixuapis.com/graphql/';\r\n  const client = new ApolloClient({\r\n    uri: endpoint,\r\n    cache: new InMemoryCache(),\r\n  });\r\n  const uploadFile = (url: string, file: File) =>\r\n    fetch(url, {\r\n      method: 'PUT',\r\n      body: file ?? new Blob(),\r\n      headers: {\r\n        'Content-Type': 'application/octet-stream',\r\n      },\r\n      mode: 'cors',\r\n    }).catch((e) => console.error(e));\r\n\r\n  type Props = {\r\n    uploadFileUrl?: {\r\n      fileName?: string;\r\n      url: string;\r\n    };\r\n  };\r\n\r\n  const result = await client\r\n    .query<Props>({\r\n      query: queryUpload,\r\n      variables: {\r\n        orgCode: removeWhiteSpaces(options?.orgcode ?? ''),\r\n        path: removeWhiteSpaces(options?.name ?? ''),\r\n        fileName: removeWhiteSpaces(options?.name ?? ''),\r\n      },\r\n    })\r\n    .then(async (res) => {\r\n      if (res?.data?.uploadFileUrl?.url) {\r\n        await uploadFile(res?.data?.uploadFileUrl?.url, image ?? ({} as File));\r\n        return res?.data?.uploadFileUrl?.fileName;\r\n      }\r\n      return image ?? ({} as File);\r\n    });\r\n  return result as any;\r\n};\r\nexport default uploadImage;\r\n"],"names":["gql","__makeTemplateObject","__awaiter","ApolloClient","InMemoryCache"],"mappings":"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"}