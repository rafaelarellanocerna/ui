{"version":3,"file":"EditorContent.js","sources":["../../../../../node_modules/@tiptap/react/src/EditorContent.tsx"],"sourcesContent":["import React, { HTMLProps } from 'react'\nimport ReactDOM from 'react-dom'\nimport { Editor } from './Editor'\nimport { ReactRenderer } from './ReactRenderer'\n\nconst Portals: React.FC<{ renderers: Map<string, ReactRenderer> }> = ({ renderers }) => {\n  return (\n    <>\n      {Array.from(renderers).map(([key, renderer]) => {\n        return ReactDOM.createPortal(\n          renderer.reactElement,\n          renderer.element,\n          key,\n        )\n      })}\n    </>\n  )\n}\n\nexport interface EditorContentProps extends HTMLProps<HTMLDivElement> {\n  editor: Editor | null,\n}\n\nexport interface EditorContentState {\n  renderers: Map<string, ReactRenderer>\n}\n\nexport class PureEditorContent extends React.Component<EditorContentProps, EditorContentState> {\n  editorContentRef: React.RefObject<any>\n\n  constructor(props: EditorContentProps) {\n    super(props)\n    this.editorContentRef = React.createRef()\n\n    this.state = {\n      renderers: new Map(),\n    }\n  }\n\n  componentDidMount() {\n    this.init()\n  }\n\n  componentDidUpdate() {\n    this.init()\n  }\n\n  init() {\n    const { editor } = this.props\n\n    if (editor && editor.options.element) {\n      if (editor.contentComponent) {\n        return\n      }\n\n      const element = this.editorContentRef.current\n\n      element.append(...editor.options.element.childNodes)\n\n      editor.setOptions({\n        element,\n      })\n\n      editor.contentComponent = this\n\n      editor.createNodeViews()\n    }\n  }\n\n  componentWillUnmount() {\n    const { editor } = this.props\n\n    if (!editor) {\n      return\n    }\n\n    if (!editor.isDestroyed) {\n      editor.view.setProps({\n        nodeViews: {},\n      })\n    }\n\n    editor.contentComponent = null\n\n    if (!editor.options.element.firstChild) {\n      return\n    }\n\n    const newElement = document.createElement('div')\n\n    newElement.append(...editor.options.element.childNodes)\n\n    editor.setOptions({\n      element: newElement,\n    })\n  }\n\n  render() {\n    const { editor, ...rest } = this.props\n\n    return (\n      <>\n        <div ref={this.editorContentRef} {...rest} />\n        <Portals renderers={this.state.renderers} />\n      </>\n    )\n  }\n}\n\nexport const EditorContent = React.memo(PureEditorContent)\n"],"names":["_jsx","_Fragment","__read","ReactDOM","__extends","React","__spreadArray","__rest","_jsxs","__assign"],"mappings":"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"}