{"version":3,"file":"runTests.js","sources":["../../../../../node_modules/yup/es/util/runTests.js"],"sourcesContent":["import ValidationError from '../ValidationError';\n\nconst once = cb => {\n  let fired = false;\n  return (...args) => {\n    if (fired) return;\n    fired = true;\n    cb(...args);\n  };\n};\n\nexport default function runTests(options, cb) {\n  let {\n    endEarly,\n    tests,\n    args,\n    value,\n    errors,\n    sort,\n    path\n  } = options;\n  let callback = once(cb);\n  let count = tests.length;\n  const nestedErrors = [];\n  errors = errors ? errors : [];\n  if (!count) return errors.length ? callback(new ValidationError(errors, value, path)) : callback(null, value);\n\n  for (let i = 0; i < tests.length; i++) {\n    const test = tests[i];\n    test(args, function finishTestRun(err) {\n      if (err) {\n        // always return early for non validation errors\n        if (!ValidationError.isError(err)) {\n          return callback(err, value);\n        }\n\n        if (endEarly) {\n          err.value = value;\n          return callback(err, value);\n        }\n\n        nestedErrors.push(err);\n      }\n\n      if (--count <= 0) {\n        if (nestedErrors.length) {\n          if (sort) nestedErrors.sort(sort); //show parent errors after the nested ones: name.first, name\n\n          if (errors.length) nestedErrors.push(...errors);\n          errors = nestedErrors;\n        }\n\n        if (errors.length) {\n          callback(new ValidationError(errors, value, path), value);\n          return;\n        }\n\n        callback(null, value);\n      }\n    });\n  }\n}"],"names":[],"mappings":";;;;AAEA,MAAM,IAAI,GAAG,EAAE,IAAI;AACnB,EAAE,IAAI,KAAK,GAAG,KAAK,CAAC;AACpB,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK;AACtB,IAAI,IAAI,KAAK,EAAE,OAAO;AACtB,IAAI,KAAK,GAAG,IAAI,CAAC;AACjB,IAAI,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;AAChB,GAAG,CAAC;AACJ,CAAC,CAAC;AACF;AACe,SAAS,QAAQ,CAAC,OAAO,EAAE,EAAE,EAAE;AAC9C,EAAE,IAAI;AACN,IAAI,QAAQ;AACZ,IAAI,KAAK;AACT,IAAI,IAAI;AACR,IAAI,KAAK;AACT,IAAI,MAAM;AACV,IAAI,IAAI;AACR,IAAI,IAAI;AACR,GAAG,GAAG,OAAO,CAAC;AACd,EAAE,IAAI,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;AAC1B,EAAE,IAAI,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC;AAC3B,EAAE,MAAM,YAAY,GAAG,EAAE,CAAC;AAC1B,EAAE,MAAM,GAAG,MAAM,GAAG,MAAM,GAAG,EAAE,CAAC;AAChC,EAAE,IAAI,CAAC,KAAK,EAAE,OAAO,MAAM,CAAC,MAAM,GAAG,QAAQ,CAAC,IAAI,eAAe,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,GAAG,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AAChH;AACA,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACzC,IAAI,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AAC1B,IAAI,IAAI,CAAC,IAAI,EAAE,SAAS,aAAa,CAAC,GAAG,EAAE;AAC3C,MAAM,IAAI,GAAG,EAAE;AACf;AACA,QAAQ,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;AAC3C,UAAU,OAAO,QAAQ,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;AACtC,SAAS;AACT;AACA,QAAQ,IAAI,QAAQ,EAAE;AACtB,UAAU,GAAG,CAAC,KAAK,GAAG,KAAK,CAAC;AAC5B,UAAU,OAAO,QAAQ,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;AACtC,SAAS;AACT;AACA,QAAQ,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAC/B,OAAO;AACP;AACA,MAAM,IAAI,EAAE,KAAK,IAAI,CAAC,EAAE;AACxB,QAAQ,IAAI,YAAY,CAAC,MAAM,EAAE;AACjC,UAAU,IAAI,IAAI,EAAE,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC5C;AACA,UAAU,IAAI,MAAM,CAAC,MAAM,EAAE,YAAY,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC;AAC1D,UAAU,MAAM,GAAG,YAAY,CAAC;AAChC,SAAS;AACT;AACA,QAAQ,IAAI,MAAM,CAAC,MAAM,EAAE;AAC3B,UAAU,QAAQ,CAAC,IAAI,eAAe,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;AACpE,UAAU,OAAO;AACjB,SAAS;AACT;AACA,QAAQ,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AAC9B,OAAO;AACP,KAAK,CAAC,CAAC;AACP,GAAG;AACH;;;;"}