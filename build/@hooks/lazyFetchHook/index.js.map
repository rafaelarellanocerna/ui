{"version":3,"file":"index.js","sources":["../../../@hooks/lazyFetchHook/index.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { useEffect, useState } from 'react';\r\n\r\ninterface PropsSettings {\r\n  onCompleted?: () => void;\r\n  onError?: () => void;\r\n}\r\n\r\nconst settingsInit = {\r\n  onCompleted: () => {\r\n    return null;\r\n  },\r\n  onError: () => {\r\n    return null;\r\n  },\r\n};\r\ninterface PropsState {\r\n  data: any;\r\n  loading: boolean;\r\n  error: any;\r\n}\r\n\r\ntype UseLazyFetchType = [\r\n  lazyFetch: () => void,\r\n  fetch: {\r\n    data: any;\r\n    loading: boolean;\r\n    error: any;\r\n    isFetch: boolean;\r\n    refetch: () => void;\r\n  }\r\n];\r\n\r\nconst useLazyFetch = (\r\n  url: RequestInfo,\r\n  setings: PropsSettings = settingsInit,\r\n  options?: RequestInit\r\n): UseLazyFetchType => {\r\n  const { onCompleted, onError } = setings;\r\n  const [refetchState, setRefetchState] = useState(false);\r\n  const [lazyRefetchState, setLazyRefetchState] = useState(false);\r\n  const [fetchState, setFetchState] = useState<PropsState>({\r\n    data: false,\r\n    error: { status: false, message: null },\r\n    loading: false,\r\n  });\r\n\r\n  const lazyFetch = () => setLazyRefetchState(true);\r\n  const refetch = () => setRefetchState(!refetchState);\r\n\r\n  useEffect(() => {\r\n    if (fetchState.data && onCompleted && lazyRefetchState) {\r\n      onCompleted();\r\n    }\r\n  }, [fetchState.data]);\r\n\r\n  useEffect(() => {\r\n    if (fetchState.error && onError && lazyRefetchState) {\r\n      onError();\r\n    }\r\n  }, [fetchState.error]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setFetchState({ error: null, data: null, loading: true });\r\n      try {\r\n        const response = await fetch(url, {\r\n          ...options,\r\n        });\r\n        const data = await response.json();\r\n        const isError =\r\n          !!data?.errors?.find((error: any) => error.status === 400) ||\r\n          data?.status === 400;\r\n        if (isError) {\r\n          setFetchState({ data: null, error: data, loading: false });\r\n        } else {\r\n          setFetchState({ error: null, data, loading: false });\r\n        }\r\n      } catch (error) {\r\n        setFetchState({ data: null, error, loading: false });\r\n      }\r\n    };\r\n    if (lazyRefetchState) {\r\n      fetchData();\r\n    }\r\n  }, [lazyRefetchState, refetchState, url]);\r\n\r\n  return [lazyFetch, { ...fetchState, isFetch: lazyRefetchState, refetch }];\r\n};\r\n\r\nexport default useLazyFetch;\r\n"],"names":["__read","useState","useEffect","__awaiter","__assign"],"mappings":"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"}